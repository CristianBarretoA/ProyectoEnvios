@model ProyectoEnvios.Models.EnvioCS

@{
    ViewBag.Title = "ConsultaGuia";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>Consulta de la Guia #@Html.DisplayFor(model => model.idEnvio)</h2>

@{
    var dateRe = "";
    var hourRe = "";
    var dateEn = "";
    var hourEn = "";
}

<div class="container">

    @if (TempData["Exito"] != null)
    {
        <div class="alert alert-success" role="alert">
            <span class="glyphicon glyphicon-ok-sign" aria-hidden="true"></span>
            <span class="sr-only">Exito:</span>
            @TempData["Exito"].ToString()
        </div>
    }

    @if (ViewData["Exito"] != null)
    {
        <div class="alert alert-success" role="alert">
            <span class="glyphicon glyphicon-ok-sign" aria-hidden="true"></span>
            <span class="sr-only">Exito:</span>
            @ViewData["Exito"].ToString()
        </div>
    }

    @if (ViewData["Error"] != null)
    {
        if (Session["userID"] != null)
        {
            <div class="alert alert-danger" role="alert">
                <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                <span class="sr-only">Error:</span>
                @ViewData["Error"].ToString()
            </div>
        }
        else
        {<div class="alert alert-danger" role="alert">
                <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                <span class="sr-only">Error:</span>
                @ViewData["Error"].ToString(), @Html.ActionLink("Click para volver atras", "Index", "Home", new { area = "" }, new { @class = "text-danger" })
            </div>
        }
    }
    else
    {
        switch (Model.estado)
        {
            case "Entregado":
                <h4 class="text-success">Estado: @Html.DisplayFor(model => model.estado)</h4>
                break;
            case "Rechazado":
                <h4 class="text-danger">Estado: @Html.DisplayFor(model => model.estado)</h4>
                break;
            default:
                <h4 class="text-primary">Estado: @Html.DisplayFor(model => model.estado)</h4>
                break;
        }
        dateRe = Model.fechaRecepcion.ToShortDateString();
        hourRe = Model.fechaRecepcion.ToShortTimeString();
        dateEn = Model.fechaEntrega.ToShortDateString();
        hourEn = Model.fechaEntrega.ToShortTimeString();
    }



    @if (Session["userID"] != null)
    {
        <hr />
        string[] user = Session["userID"].ToString().Split(',');
        if (user[1].Equals("Mensajero"))
        {
            using (Html.BeginForm())
            {
                <input name="idEnvio" id="idEnvio" hidden="hidden" value="@Model.idEnvio" />
                <div class="row">
                    <div class="col-md-4 col-md-offset-1">
                        <div class="form-group">
                            @Html.LabelFor(model => model.estado, htmlAttributes: new { @class = "control-label col-md-5" })
                            <br /><br />
                            <div class="col-md-10">
                                @Html.Action("_ListarEstados")
                                @Html.ValidationMessageFor(model => model.idEstado, "", new { @class = "text-danger" })
                            </div>
                        </div>
                    </div>

                    <div class="col-md-4">
                        <div class="form-group">
                            <br /><br />
                            <div class="col-md-1">
                                <input type="submit" value="Cambiar Estado" class="btn btn-primary" />
                            </div>
                        </div>
                    </div>
                </div>
            }
        }
    }



    <hr />

    <div class="container-fluid col-md-8 col-md-offset-2">
        <div class="row">
            <h3 style="background-color:lightgray; padding:10px;">REMITENTE/ORIGEN</h3>
            <hr />
            <div class="col-md-5 col-md-offset-1">
                <p>Ciudad de Origen</p>
                <p>@Html.DisplayFor(model => model.origen)</p>
            </div>
            <div class="col-md-5 col-md-offset-1">
                <p>Ciudad de Destino</p>
                <p>@Html.DisplayFor(model => model.destino)</p>
            </div>
        </div>
        <div class="row">
            <hr />
            <div class="col-md-5 col-md-offset-1">
                <p>Fecha de Repecion</p>
                <p>@Html.DisplayFor(model => dateRe)</p>
            </div>
            <div class="col-md-5 col-md-offset-1">
                <p>Hora de Recepcion</p>
                <p>@Html.DisplayFor(model => hourRe)</p>
            </div>
        </div>
        <div class="row">
            <hr />
            <div class="col-md-5 col-md-offset-1">
                <p>Nombre de Remitente</p>
                <p>@Html.DisplayFor(model => model.nombreRemitente)</p>
            </div>
            <div class="col-md-5 col-md-offset-1">
                <p>Direccion</p>
                <p>@Html.DisplayFor(model => model.direccionOrigen)</p>
            </div>
        </div>
        <div class="row">
            <hr />
            <div class="col-md-5 col-md-offset-1">
                <p>Tipo de Producto</p>
                <p>@Html.DisplayFor(model => model.tipoProducto)</p>
            </div>
            <div class="col-md-5 col-md-offset-1">
                <p>Peso total (Kg)</p>
                <p>@Html.DisplayFor(model => model.peso)</p>
            </div>
        </div>


        <div class="row">
            <h3 style="background-color:lightgray; padding:10px;">DESTINATARIO/DESTINO</h3>
            <hr />
            <div class="col-md-5 col-md-offset-1">
                <p>Ciudad de Origen</p>
                <p>@Html.DisplayFor(model => model.origen)</p>
            </div>
            <div class="col-md-5 col-md-offset-1">
                <p>Ciudad de Destino</p>
                <p>@Html.DisplayFor(model => model.destino)</p>
            </div>
        </div>
        <div class="row">
            <hr />
            <div class="col-md-5 col-md-offset-1">
                <p>Fecha de Entrega</p>
                <p>@Html.DisplayFor(model => dateEn)</p>
            </div>
            <div class="col-md-5 col-md-offset-1">
                <p>Hora de Entrega</p>
                <p>@Html.DisplayFor(model => hourEn)</p>
            </div>
        </div>
        <div class="row">
            <hr />
            <div class="col-md-5 col-md-offset-1">
                <p>Nombre de Destinatario</p>
                <p>@Html.DisplayFor(model => model.nombreDestinatario)</p>
            </div>
            <div class="col-md-5 col-md-offset-1">
                <p>Direccion</p>
                <p>@Html.DisplayFor(model => model.direccionDestino)</p>
            </div>
        </div>
    </div>

</div>
@if (Session["userID"] == null)
{
    <div class="row">
        <p>
            @Html.ActionLink("Volver Atras", "Index", "Home")
        </p>
    </div>
}



